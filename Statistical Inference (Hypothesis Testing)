#### STATISTICAL INFERENCE HYPOTHESIS TESTING

#H₀ (Null Hypothesis): ESG performance has no meaningful relationship with financial or environmental outcomes.
#H₁ (Alternative Hypothesis): Companies with higher ESG performance tend to exhibit better financial performance (e.g., higher ProfitMargin) and lower environmental impact (e.g., lower CarbonEmissions, WaterUsage, EnergyConsumption).

print("1.ESG Score vs. Profit Margin")

# Cleaned the data specifically for this pair
esg_profit_data = Merged.dropna(subset=['ESG_Overall', 'ProfitMargin'])
corr_coef, p_value = pearsonr(esg_profit_data['ESG_Overall'], esg_profit_data['ProfitMargin'])

print("\nPearson Correlation (r): {:.4f}".format(corr_coef))
print("P-value:                 {:.4e}".format(p_value))

if p_value < 0.05:
    if corr_coef > 0:
        print("\nReject H0 (Significant relationship).")
        print("Higher ESG scores correlate with higher profit margins.")
    else:
        print("Interpretation: Higher ESG scores correlate with LOWER profit margins.")
else:
    print("\nFAIL TO REJECT H0 (No significant relationship).")
    print("ESG scores do not meaningfully predict profit margins.")

print("\n2.Does Wealthier Regions Have Higher ESG Scores?")

# Define High vs. Low GDP groups
gdp_median = Merged['GDP'].median()
high_gdp_group = Merged[Merged['GDP'] > gdp_median]['ESG_Overall']
low_gdp_group = Merged[Merged['GDP'] <= gdp_median]['ESG_Overall']

# Run T-test
t_stat, p_val_gdp = ttest_ind(high_gdp_group, low_gdp_group, equal_var=False)

print("\nT-statistic:             {:.4f}".format(t_stat))
print("P-value:                 {:.4e}".format(p_val_gdp))

if p_val_gdp < 0.05:
    if t_stat > 0:
        print("\nReject H0 (Significant relationship).")
        print("Wealthier regions have significantly higher ESG scores.")
    else:
        print("\nLower GDP regions actually have higher ESG scores.")
else:
    print("\nFAIL TO REJECT H0 (No significant relationship).")
    print("\nRegional wealth does not dictate ESG performance.")

print("\n3.ESG Score vs. Environmental Impact")

metrics = ['CarbonEmissions', 'WaterUsage', 'EnergyConsumption']

for metric in metrics:
    metric_data = Merged.dropna(subset=['ESG_Overall', metric])
    corr, p_val = pearsonr(metric_data['ESG_Overall'], metric_data[metric])

    print("\nTarget Variable: {}".format(metric))
    print("Correlation (r): {:.4f}".format(corr))
    print("P-value:         {:.4e}".format(p_val))

    if p_val < 0.05:
        if corr < 0:
            print("\n   Reject H0 (Significant relationship).")
            print("   Higher ESG scores are linked to lower {}.".format(metric))
        else:
            print("   Higher ESG scores are linked to HIGHER {}.".format(metric))
    else:
        print("\n   FAIL TO REJECT H0 (No significant relationship).")
        print("   No clear link between ESG and {}.".format(metric))
